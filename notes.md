# CS240 Notes

## Java Overview
**Differences from C++**
- References instead of pointers
- Built in garbage collection
- Data types are always the same size in Java

### Fun facts
Java is a compiled language, it uses Byte Code generated by the compiler to then send to the JVM.

Interpreter languages are things like JavaScript and Python

The name of the class has to be named the same as the file.

**How to run a Java File:**
```cmd
java --cp bin/ X arg1 arg2 ...
```

### Coding Examples in java 

```java
public class SimpleJavaClass {
    
    private int x;
    private static boolean b; //static functions can access static variables
    
    public static void main(String[] args){// static means that it's a method of the class itself, NOT attached to an object, standalone function
        System.out.println("Hello from SimpleJavaClass");
    } 
}
```

## Javadoc

JDK documentation from Oracle, available to use on the test!

## Wrappers vs Primitive

Byte and byte

use the Wrapper to be able to manipulate and change between strings, ints, etc.

## Strings

**Strings are objects!**

They are also immutable, meaning they cant be altered, to change a string, you must make
a new one.

```java
String.format("%s %s", s1, s2); 
//%s are placeholders for strings
```

Stringbuilder
```java
StringBuilder builder = new StringBuilder();
builder.append("Using ");
//.. the rest of the code
```

## Pointer stuff

```java
public static void main(String[] args){
    Point t1 = new Point (10, 10);
    Point br = new Point (20, 20);
    Rectangle r = new Rectangle(t1, br);
    int w = 5;
    String text = args[0];
    
    boolean ok = drawRectangle(r, w, text);
}


public boolean drawRectangle (Rectangle rect, int width, String label){
    
}
```

## Arrays

Hardcoding the values in:
```java
int [] myArray = {2, 5, 4, 1};
```

string array
```java
String [] myStringArray = {"What", "is", "up"};
```

# 1/17/23
## Objects, Classes, Packages, and Records

### Chess stuff rq

Move Calculator with head class
```java
pieceMoves(board: ChessBoard, position: ChessPosition): Collection<ChessMove>
```

Have this for a Pawn, King, Queen moves calculator etc.

Right-click the chess folder and do run all tests for the pass-off

**Package** 
- just a folder
- No imports necessary when things are in the same package

**Collection**
- Highest level base class of data structures in Java

### Order of data structures
- Collection
  - List
    - ArrayList
    - LinkedList
  - Set
    - TreeSet
    - HashSet


**Java Class in Full Glory**

```java
package school;

public enum YearInSchool{
    FRESHMAN,
    SOPHOMORE,
    JUNIOR,
    SENIOR,
    GRADUATE
}
```
```java
package school;

public class Person{
    private String name;
    private int age;
    private YearInSchool year;
    
    public Person(String name, int age, YearInSchool year){
        setnName(name);
        setAge(age);
        setYear(year);
    }
    
    public Person(String name, int age){
        this(name, age, YearInSchool.FRESHMAN);
        // This calls the other constructor
    }
    
    public String getName(){
        return name;
    }
    
    // rest of getters and setters ...
    
    @Override
    public String toString(){
        return String.format("Person(name=%s, age=%d, year=%s)", name, age, year);
    }
    
    @Override
    public boolean equals(Object o){
        if (o == null){
            return false;
        }
        if (o == this){
            return true;
        }
        if (this.getClass() != o.getClass()){
            return false;
        }
        
        Person other = (Person)o;
        
        return (this.name.equals(other.name) && (this.age == other.age) && (this.year == other.year));
    }
    
    // a hash table is really just an array
    // returns an integer to decide which place it will be in the array
  
    @Override
    public int hashCode(){
        return (name.hashCode() + age + year.hashCode());
    }
    
    public int getPriorit(){
        return getCategoryPriority() * getAgePriority();
    }
    protected int getCategoryPriority(){ //protected, subclasses can see it, but not anybody outside the family
        return 1;
    }
    protected int getAgePriority(){
        return 1;
    }
}
```
```java
private student (String name, int age, float gpa, YearInSchool year) {
    super (name, age);
    setGpa(gpa);
    setYear(year);
}

@Override
public String toString() {
    return super.toString() + String.format(", gpa: %f, year: %s", gpa, year);
}

@Override
public boolean equals(Object o){
  if (!super.equals(o)){
      return false;
  }
  
  Student other = (Student)o;
  
  return (gpa == other.gpa && year == other.year);
}

@Override
public int hashCode(){
    
    
    int hash = super.hashCode();
    return(hash ^ (int)gpa ^ year.hashCode());
}

@Override
protected int getCategoryPriority(){
    return 4;
}

@Override
protected int getAgePriority(){
    return (getAge() / 10);
}
```


# 1/22/24

## Creating an Interface

```java
public interface Moveable
```

If several classes implement the same method interface, what is the 
likelihood that there is some duplicated code between them?

Create an abstract class that contains the code shared by the subclasses!

# 1/24/24

### Shallow Copy vs Deep Copy

- **Shallow copy** just copies the first level, so in a linked list, it would just
take the first node.

- **Deep copy** would copy everything

* Immutable objects can be safely shared and don't need to be copies, like an "int"

```java
// Copy Constructor

public class Person implements Cloneable{
    
    private int id;
    private String name;
    
    public Person(int id, String name){
        this.id = id;
        this.name = name;
    }
    
    public Person(person other){
      setId(other.id);
      setName(other.setName);
    }
  
    @Override // Must override because Java assumes that things are not cloneable
    public Person clone() {
      return new Person(this);
    }
}


// Takes in the parameters of the entire object itself
// But it is not enough, you got to do the other stuff

// Here is the parent class

public Faculty(Faculty other) {
    super(other);
    
    courses = new ArrayList<Course>();
    for(Course c: other.courses){
        courses.add(new Course(c));
    }
    
    students = new ArrayList<Student>();
    for (Student s : other.students) {
        students.add(new Student(s));
    }
}
```

## Data Structures

### Queue

- *add(value)*
- *peek()*
- *remove()*

- **Different thingies**
  - ArrayDeque(fifo, resizable array impl)
  - LinkedList(fifo, linked list implementation)
  - PriorityQueue

### Deque

Allows for insertion and removal at both ends

- addFirst(value), addLast(value)
- peekFirst(), peekLast()

### Stack

Java's Stack class is deprecated, so don't use it!
* Use a deque instead!

### Map

Collection of key value pairs

- *put(key, value)*
- *get(key)*
- *contains(key)*
- *remove(key)*
- *keySet()*, returns set with all the keys in the map
- *values()*, this is not a set, values don't have to be unique
- *entrySet()*, gives you back the set of key value pairs! Best way to iterate over map

## Iterating

```java
for (String w: words) {...}
```

So that goes through all of the stuff in words

## Equality Checking

default equals method compares references, but we would rather compare content!

Overwrite equals with hashcode! remember to do it with
i am using any of the collections implemented
with hash tables


### Sorted Collections

```java
import java.sql.Time;

public class TimeOfDay implements Comparable<TimeOfDay>{
    
    private int hour;
    private int minute;
    
    public TimeOfDay(){
        setHour(0);
        setMinutes(0);
    }
    
    // getters and setters ........
    
    @Override
    public int compareTo(TimeOfDay timeofDay){
        
        int result = Integer.compare(hour, timeofDay.hour);
        if (result == 0){
            result = Integer.compare(minute, timeOfDay.minute);
        }
        return result;
    }
}
```

## Exceptions

In Java, you have to throw an **OBJECT**
```java
try{
    // code that may throw an exception
} catch(SomeExcetpionType ex){
    // Code to hand the exception
} //more catches and such
```

# 1/29/24

## Software Design Principles

My Code should:
- **Work**
- Be **easy** to **understand, debug**, and **maintain**
- Hold up well under changes
- Have **reusable components**

### Decomposition

- Decompose a program into classes
- Use separate classes to represent each concept in the application domain
- Identify relationships between classes
  - Inheritance?
  - Has-A vs Uses-A relationship?

**Levels of decomposition**
- system
- subsystem
- packages
- classes
- methods

**Single Responsibility**
- Each abstraction should have a single responsibility
- Each class should represent one, well-defined concept

**Good Naming**
- get really good at picking good names, take it seriously
- Classes are nouns. Variables are nouns. Methods are verbs!

**Good algorithm and data structure selection!**
- a flawed algorithm or data structure will mess stuff up like crazy!

**Information hiding**
- A class should hide its internal implementation as much as it can
  - knowing the access levels of "public", "private", and "protected"
- don't let details leak out of the class
  - *ClassRoll* instead of *StudentLinkedList*

**Avoid Code Duplication**
- DRY principle: Don't repeat yourself
- This should be ***STRENUOUSLY AVOIDED***

### Writing Quality Code

A singular method shouldn't be longer than a single sheet of paper.

**Names**
- if code gets too complicated, it will be harder to name!

**Comments**
- Make sure the code stays readable!
- If too many comments are required, maybe consider further decomposition

**Deep Nesting**
- Excessive layers of nesting can make things very confusing!
- Creating additional sub-methods may be the best way to remove deep nesting

**Method Parameters**
- Use all of the parameters
- Don't make it have too many

# 1/31/24

In Intellij, under the "code" tab, go to "inspect code". Cool stuff!

## Generic Types

### Example of Generic class
```java
public class Pair<T, U> {
    private T value1;
    private U value2;
}

public Pair(T value1, U value2){
    this.value1 = value1;
    this.value2 = value2;
}

//... GETTERS AND SETTERS ...//

```

```java
var pair1 = new Pair<String, Integer> {};// theres more lol
```

## Inner Classes

the anonymous inner class is the most important one
```java
public Iterator iterator(final int increment) {
    return new Iterator(){
        
        private int next = 0;
        
        public boolean hasNex() {
            return (next <= SIZE - 1);
        }
        
        //a few more
    }; // <<<<<<--------- take a look at that semi colo lmaoooo raaaahhhh
}
```

## Functional Interfaces

### Lambda Functions

- a block of code with the specification of any parameters that must be passed to it, 
that can be stored in variables, passed as parameters, and executed later

```java
Arrays.sort(stringArray, (first, second) -> Integer.compare(first.length(), second.length()));
```



```java
public class LambdaVariable{
  Predicate<String> strLenPredicate = s -> s.length() > 10;
}
strLenPredicate(myString);
```

# 2/5/24

## Chess Server Design

There are clients and servers, pretty cool right?

### Web API
- A method to build distributive systems
- the server has functions that it implements

### Packages of classes for server

#### Model
- User
- Auth Token
- Game

### Data Access
- **Connects to model**
- UserDao
- AuthTokenDao
- GameDao
- **CRUD** operations
  - create
  - read
  - update
  - delete

```java
class UserDao{
    void createUser(UserData user);
    
    UserData getUser(String username);
    
    void clear();
}
```

On the other side.........

### Server
- Connects to
  - **Handlers**
    - register handler
    - login handler
    - clear handler
    - join handler
    - more...
  - *Which all connect to*
    - **Request/Result**
      - Register request
      - register result
      - login request
      - login result
    - **Handlers also connect to**
      - services which all have the same things as the others, but end in "service"
      - The register service connect to **Data Access** and **Model** packages
      - The services actually get stuff done, they implement the functions of the server
      - Another thing: Object encoder / Decoders

# 2/7/24

## Javadoc

```java
/**
 * Something cool
 * @param coolThing important parameter!      
 */
```
- use this before the method declaration to explain what it is.
- tool > generate javadoc
  - creates a cool website!

### Streams vs Readers/Writers
- reading **BINARY** versus **TEXTUAL** information

### File
- There is a file class so wrap the file path in the file object

## JSON

Simple data format that is based off of JavaScript that
makes it easier to share data and use Object / Class relationships
- It's essentially a textual format to represent a tree.

*DOM* 
- Document Object Model
- Creates a tree
- Used to read through JSON stuff

### GSON
```java
private void generate (Catalog catalog, File file) throws IOException{
    Gson gson = new GsonBuilder().setPrettyPrinting().create();
    String jsonString = gson.toJson(catalog);
    
    //..... cool stuff here to read the file
}
```

```java
// Register a type adapter for the automobile interface
GsonBuilder builder = newGsonBuilder();
builder.registerTypeAdapter(Automobile.class, new AutomobileTypeAdapter());
Gson gson = builder.create();
```

# 2/12/24

## HTTP and cURL

### HTTP

HyperText Transport Protocol
- Responses and Requests, constant communication between client and server
- Headers: Metadata for requests and responses

**GET** Request
- gets whatever URL points at

**POST** Request
- server processes data

### WEB APIs

There are also **GET** requests in Web apis.
- an API call which HTTP requests

REQUEST TYPE (GET, POST, PUT, DELETE) -->  URL Path  -->  HTTP Version

How clients can pass information via WEB apis to server:
- URL, parameters
- Headers
- Request body

### cURL

command line tool

# 2/14/24

## Spark!

```java
import spark.Spark;

public class SimplehelloBYUServer{
    public static void main (String[] args) {
        Spark.get("/hello", (req, res) -> "Hello BYU!");
    }
}
```
* listens on port 4567

After running the server, go to cmd and type in 
```cmd
curl http://localhost:8080/hello
```

```java
// matches "GET /hello/foo and "GET /hello/var"
get("/hello/:name", (request, response) ->)
    return "Hello: " + request.params(":name");
```

*SPLAT*
```java
// matches "GET / say/hello/to/world"
// request.splat()[0] is 'hello' and
// request.splat()[1] 'world'
get ("/say/*/to/*", (request, response) ->
//...
```


Start's in the public folder in the resources folder, with this:
```java
Spark.staticFiles.location("/public");
```


Adding spark to a project
- project structure > modules > dependencies > search for spark java
- You might have to add this text to the pom.xml as well
```xml
<depenency>
  <groupId>com.sparkjava</groupId>
  <artifactId>spark-core</artifactId>
  <version>2.9.4</version>
</depenency>
```

# 2/20/24

## Server

handler logic EXAMPLE
```java
LoginRequest request = (LoginRequest)gson.fromJson(reqData, LoginRequest.class);

LoginService service = new LoginService();
LoginResult result = service.login(request);

return gson.toJson(result);
```

Generating authToken
```java
UUID.randomUUID().toString();
```

## Tests

Create unit tests that will be cool and help test individual methods
Have tests have a very similar layout or file path as the thing they are testing.
- example test
```java
import org.junit.jupiter.api.Test;

class SomeClassTest {
 
  @Test
  public void testSum_TwoPositive(){
      
      var someObject = new SomeClass();
      
      int x = 2;
      int y = 100;
      
      int expected = 102;
      
      Assertions.assertEquals(expected, someObject.sum(x, y));
  }
}
```

To avoid code duplication, consider adding a "@BeforeEach" test to perhaps initialize
the variables to the right things.

- For the database tests, make sure to clear the database before each test


# 2/26/24

#### Coverage

- a way to measure the thoroughness of my tests, seeing how much code is actually tested per test
- helpful to see what parts of your code still need to be tested

## Relational Databases

Programs can access a database through APIs such as JDBC.
- Uses SQL to manipulate database.
- Everything is sorted in rows.

We are going to use ***MySQL***

#### Relational Data Model
- Class --> table
- Object --> Row
- Relationship(reference) -->Relationship (primary and foreign key)


#### Object Relationships

- One-to-One
- One-to-Many
- Many-to-Many

## Structured Query Language (SQL)

The world's most popular database manipulation language!

- Each colum in an SQL table declares the type that column may contain
- **Character strings**
  - CHARACTER(n) or CHAR(n) -- fixed-width n-character string, padded with spaces as needed
  - CHARACTER VARYING(n) or VARCHAR(n) -- variable-width string with a maxiumum size of *n* characters
- **Numbers**
  - INTEGER and SMALLINT
  - FLOAT, REAL, and DOUBLE PRECISION
  - NUMERIC(*precision, scale*) or DECIMAL(*precision, scale*)
- **Large Objects**
  - BLOB -- binary large object (images, sound, video, etc.)
  - CLOB -- character large object (text documents)
- **Date and Time**
  - DATE
  - TIME
  - TIME WITH TIME ZONE or TIMEZ
  - TIMESTAMP (DATE and TIME put together)
  - TIMESTAMP WITH TIME ZONE or TIMESTAMPTZ 
- **CREATE TABLE**
  - Primary key
  - null / not null
  - Autoincrement
  - Foreign keys

```sql
create table book (
    id integer not null primary key auto_increment,
    title varchar(255) not null, 
    author varchar(255) not null, 
    genre varchar(32) not null, 
    category_id integer not null, 
    foreign key(genre) references genre(genre),
    foreign key(category_id) references category(id)
)
```

# 2/28/24

### SQL stuff

- sql is not case sensitive, so do whatever you want with capital letters haha

Dropping a table?
```sql
drop table if exists book;
```

insert a row into a table?
```sql
insert into book
(title, author, genre, category_id) values ('The Work' 
' and the Glory', 'Gerald Lunc', 'HistoricalFIction', 3);
```

update table?
```sql
UPDATE member
Set name = 'Chris Jones',
    email_address = 'chris@gmail.com'
WHERE id = 3
```

delete rows from a table?
```sql
DELETE FROM member
WHERE id = 3
```
```sql
DELETE FROM books_read
WHERE member_id = 3
```
this one works like clear for the whole row
```sql
DELETE FROM book
```

Queries (complicated)
```sql
SELECT Column, Column, Column
FROM Table, Table
WHERE Condition
```

List all books using SELECT
```sql
SELECT * FROM book
```

list the authors and the titles of all non-fiction books
```sql
SELECT author, title
FROM book
WHERE genre = "NonFiction"
```

List the sub-categories of category 'Top'
```sql
SELECT id, name, parent_id
FROM category
WHERE parent_id = 1
```

Queries - Join
```sql
SELECT member.name, book.title
FROM member, books_read, book
WHERE member.id = books_read.member_id AND 
      book.id = books_read.book_id
```

```sql
SELECT member.name, book.title
FROM member
INNER JOIN books_read ON member.id = books_read.member_id
INNER JOIN book ON books_read.book_id = book.id
WHERE gner = "NonFiction"
```

### Java Database Access with JDBC

Open a Database Connection / Start a transaction

```java
import java.sql.*;
// ...... \\
String connectionURL = "jdbc:mysql://localhost:3306/BookClub?" + 
    "user=user&password=mypassword";

Connection connection = null;
try(Connection c = DriverManager.getConnection(connectionURL)) {
    connection = c;
    
    //Start a transaction
    connection.setAutoCommit(false);
} catch (SQLExcetpion ex) {
    
}
```

Execute a query
```java

List<Book> books = new ArrayList<>();

String sql = "select id, title, author, genre, category_id from book";

try (PreparedStatement stmt = conneciton.prepareStatement(sql);
    ResultSet rs = stmt.executeQuery())  {
    while(rs.next()){
        int id = rs.getInt(1);
        String title = rs.getString(2);
        String author = rs.getSring(3);
        String genre = rs.getSTring(4);
        int categoryId = rs.getInt(5);
        books.add(new Book(id, title, authro genre, categoryId));
        }
    catch(SQLException ex) {
        // Error message;
    }
}
```

Execute an insert, update, or delete

```java

String sql = "update book " + "set title = ?, author = ?, genre = ?, category_id = ? " +
             "where id = ?";

// ..... \\

if(stmt.executeUpdate() == 1) {
    System.out.println("Updated book " + book.getId());
} else {
    System.out.println("Failed to update book " + book.getId());
}
```

commit or rollback a transaciton when it's done

```java
try(...){
    
    connection.commit();
} catch(SQLException ex) {
    connection.rollback();
}
```

# 3/4/24

### Database Transactions

run the statements inside of a transaction, that way it can help if things go wrong!
- COMMIT TRANSACTION; or ROLLBACK TRANSACTION

```java
//start a transaction
connection.setAutoCommit(false);

// a lot of code

//commit transaction
connection.commit();
```
```java
//configure database
priavte void configureDatabase() throws ResponseExcetption{
    DatabaseManager.createDatabase();
    try(...)
      
      // there's the rest of the code in petshop, consider using it and putting it in!
}
```

### Storing Passwords

- Use BCrypt to store a hashed version of the password
- this hash cannot be reverse engineered
```java
BCryptPasswordEncoder encoder = new BCryptPasswordEncoder();
String secret = "asdfj;lk";
String has = encoder.encode(secret);

String[] passwords = {"cow", "asdfj;lk", "password"};
for (var pw : passwords) {
    var match = encoder.matches(pw, hash) ? "==" : "!=";
    
    System.out.printf("%s %s %s%n", pw, match, secret);
}
```

# 3/6/24

### Logging
- prints information about different processes of a program while it's executing
- Also has **Stack Traces**
  - seeing what king of stuff gets added to a stack
  - useful stuff

### Defensive Programming
- **Assertions**
  - Different from JUnit tests
  - As we program we make many assumptions about the state of the program at each point in the code
  - So Assertions are little tests cases sprinkled throughout the ode that alert you when an assumption is wrong
- **Parameter Checking**
  - check input parameters for functions to see if they work and such

### Debugging
- Consider assertions and parameter checking as an early way to detect bugs
- Make reproducible test cases
- Have smaller input files!
  - If it takes 30 minutes to find the bug, big rip...
- Consider the scientific method hehateha 

# 3/11/24

## Client Web API

**HttpURLConnection** is the same as a JS "fetch"

```java
class ServerFacade {
    RegisterResult register(RegisterRequest req);
    LoginResult login(LoginRequest req);
}
```
Java has a class named **URL**, put a string in it to build the URL object
```java
URL url = new URL(urlString);
```

Then get the connection!
```java
HttpURLConnection connection = (HttpURLConnection) url.openConnection();
```
**GET** vs **POST**
- Post has a body!
```java
connection.setRequestMethod("POST");
connection.setDoOutput(true);
```

That setDoOutput thing is for the body, also make sure to close the stream!

- use the petshop code to help with all the requests and such
- Start by writing the serverfacade, then the tests

*MORE!* - Here's how to initialize every unicode thing in java.
```java
public static final String UNICODE_ESCAPE = "\u001b";
```

USe the unicode characters for the chess pieces :) 

# 3/18/24

## WebSocket

- start off using HTTP to establish something, and websocket keeps it open

```java

import WebSocket; //not sure if this is actually how to bring it in haha

@WebSocket
public class WSServer {
    public static void main (String[] args) {
        Spark.port(8080);
        Spark.webSocket("/connect", WSServer.class);
        Spark.get("/echo/:msg", (req, res) -> "HTTP Response: " + req.params(":msg"));
    }
    
    @OnWebSocketMessage
    public void onMessage(Session session, String message) throws Exception {
        session.getRemote().sendString("WebSocket response: " + message);
    }
}
```

- Use a concurrent hashmap to take care of the Connections
- go to the Connection Manager in PetShop and use similar stuff to make it work
- WebSocket will pretty much just be used for handling the game itself
  - So nothing to do with pre/post login UI

# 3/25/24
## Computer Security

**Important stuff**
- Data Confidentiality
- Authentication
- Data Integrity
- Non-repudiation

### Cryptographic (one-way) Hash Functions

INPUT: FOX  **-->** Cryptographic hash function **-->** DIGEST: EIFJ 384 DOFE 304A
- the digest should be deterministic, the same input should always produce the same output
- also, given the digest and the hash function, people shouldn't be able produce the input.


#### Password hashing

- regular password hashing ins't enough for security, hay que add salt!
- for each user, there is a random SALT value that gets added to the password hash
- that forces all the hashes to be unique!
- Salt gets stored in the database. 


#### Encryption

- Plaintext: "hello!"
- CipherText: "6&eh#8f^7"
- Key: A sequence of bits used as input to cryptographic algorithm to encode or decode data
- Key Size: The number of bits in the key, big keys are better!
  - 128 bits, 2048 bits?

# 3/27/24

- Symmetric and Asymmetric Key Encryption
  - Advanced Encryption Standard (AES)

```java
private static SecretKey createAESKey() throws Exception
{
    KeyGenerator keyGen =KeyGenerator.getInstance("AES");
    keyGen.init(256);
    Secrety key = keyGen.generateKey();
    return key;
}
```

### Public Key Encryption
- a key pair, generated together!
- Given one of the keys, it is infeasible to calculate the other key

```java
import java.security.KeyPairGenerator;

private static SecretKey createAESKeyPair() throws Exception {
  KeyPairGenerator keyGen = KeyPairGenerator.getInstance("AES");
  keyPair.init(256);
  Secrety key = keyGen.generateKey();
  return key;
}
```

# 4/1/24

## Concurrency

having multiple things going on at the same time
- having "threads" run in parallel, main may be 1 of them!
- don't always print ou the same thing! Threads may go at different speeds